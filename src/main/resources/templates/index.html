<!DOCTYPE html>
<html>
<body>
<div class="container">
<h1 style="text-align:center;">VoIP Server!</h1>
<p>All server information goes here.</p>
</div>
<div class="container">
    <p>
      Discover what fart you are! Simply enter the first letter of your name and the day of the month you were born! Ex: A 18
    </p>

    <input type="text" id="stdin"/>
    <p id="credits"></p>
    <form id="form">
      <button id="run">Run</button>
    </form>
    <code id="output"></code>

    <script>
    var run = document.getElementById("run");

    run.addEventListener("click", function (e) {

      e.preventDefault();

      var stdin = document.getElementById("stdin");
      var form = document.getElementById("form");
      var credits = document.getElementById("credits");
      var output = document.getElementById("output");

      output.innerHTML = "Loading...";

      console.log(stdin.value);

      var obj = {};
      obj["clientId"] = "356ce739a260e06fe9d14be71bf8975f";
      obj["clientSecret"] = "db4b076db1ca4344052487e8a8a1932ca42c3fef453d36bbdb43d26977919844";
      obj["script"] = "
      import java.util.HashMap;
      import java.util.Scanner;

      public class Farts {

      	public static void main(String[] args) {
      		Scanner scan = new Scanner(System.in);

      		String letter = scan.next().toUpperCase();
      		int day = scan.nextInt();

      		HashMap<String, String> letters = new HashMap<String, String>();
      		letters.put(\"A\", \"WRETCHED\");
      		letters.put(\"B\", \"DEEPLY\");
      		letters.put(\"C\", \"PHENOMENAL\");
      		letters.put(\"D\", \"GROSSLY\");
      		letters.put(\"E\", \"MONUMENTAL\");
      		letters.put(\"F\", \"EXPLOSIVE\");
      		letters.put(\"G\", \"UNEXPECTEDLY\");
      		letters.put(\"H\", \"THICK\");
      		letters.put(\"I\", \"TINY\");
      		letters.put(\"J\", \"LONG\");
      		letters.put(\"K\", \"GIGANTIC\");
      		letters.put(\"L\", \"TREMENDOUS\");
      		letters.put(\"M\", \"DANGEROUSLY\");
      		letters.put(\"N\", \"CRAZY\");
      		letters.put(\"O\", \"SCRAWNY\");
      		letters.put(\"P\", \"BEAUTIFLY\");
      		letters.put(\"Q\", \"ROTTENLY\");
      		letters.put(\"R\", \"SPOOKY\");
      		letters.put(\"S\", \"LUMPY\");
      		letters.put(\"T\", \"MODERATELY\");
      		letters.put(\"U\", \"HAPPY\");
      		letters.put(\"V\", \"TROUBLESOME\");
      		letters.put(\"W\", \"SAGGY\");
      		letters.put(\"X\", \"HEARTY\");
      		letters.put(\"Y\", \"BIG\");
      		letters.put(\"Z\", \"LUXURIOUS\");

      		HashMap<Integer, String> days = new HashMap<Integer, String>();
      		days.put(1, \"SOUR\");
      		days.put(2, \"GREAT\");
      		days.put(3, \"OLD\");
      		days.put(4, \"LOUD\");
      		days.put(5, \"LITTLE\");
      		days.put(6, \"EPIC\");
      		days.put(7, \"WET\");
      		days.put(8, \"DANK\");
      		days.put(9, \"FAKE\");
      		days.put(10, \"SENILE\");
      		days.put(11, \"MUSTY\");
      		days.put(12, \"SHARP\");
      		days.put(13, \"DANGEROUS\");
      		days.put(14, \"MONOTONE\");
      		days.put(15, \"SQUEAKY\");
      		days.put(16, \"NOISELESS\");
      		days.put(17, \"ROTTEN\");
      		days.put(18, \"FAT\");
      		days.put(19, \"SOFT\");
      		days.put(20, \"POTENT\");
      		days.put(21, \"SUDDEN\");
      		days.put(22, \"POWERFUL\");
      		days.put(23, \"STRANGE\");
      		days.put(24, \"STURDY\");
      		days.put(25, \"FLAT\");
      		days.put(26, \"FULL\");
      		days.put(27, \"WINDY\");
      		days.put(28, \"HORRID\");
      		days.put(29, \"BEAUTIFUL\");
      		days.put(30, \"HOT\");
      		days.put(31, \"SILENT\");

      		System.out.println(\"You are a \" + letters.get(letter) + \" \"
      				+ days.get(day) + \" FART\");
      	}

      }

      ";
      obj["language"] = "java";
      obj["versionIndex"] = "0";
      obj["stdin"] = stdin.value;
      var jsonStr = JSON.stringify(obj);

      console.log(jsonStr);

      const proxyurl = "https://cors-anywhere.herokuapp.com/";
      const url = "https://api.jdoodle.com/v1/execute";
      fetch(proxyurl + url, {
        method: 'post',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        body: jsonStr
      })
      .then(response => {
        return response.json()
      })
      .then(data => {
        console.log(data);
        var outputStr = data.output;
        console.log(outputStr);
        var formattedOutput = outputStr.replace(/(?:\r\n|\r|\n)/g, '<br>');
        output.innerHTML = formattedOutput;
      })
      .catch(() => console.log("Can’t access " + url + " response. Blocked by browser?"))

      const creditsUrl = "https://api.jdoodle.com/v1/credit-spent";
      fetch(proxyurl + creditsUrl, {
        method: 'post',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        body: jsonStr
      })
      .then(response => {
        return response.json()
      })
      .then(data => {
        console.log(data);
        var creditsLeft = 99999 - data.used;
        console.log(credits);
        credits.innerHTML = "Runs left: " + creditsLeft;
      })
      .catch(() => console.log("Can’t access " + url + " response. Blocked by browser?"))




    });
    </script>
</div>
</body>
</html>
